$(document).ready((function(){var e=!1,t=parseInt($('[name="type_id"]').val());function o(){$(".categoriex").click((function(){if(confirm("Étes-vous sûr?")){var e=$(this);categorie_id=$(this).attr("data-id"),$.ajax({method:"delete",url:"/coulisses/categorie/"+categorie_id,data:{_token:$('[name="csrf-token"]').attr("content")}}).done((function(t){e.parents("tr").first().remove()})).fail((function(e){console.log(e),alert("Connexion impossible pour supprimer la catégorie.")}))}}))}function a(){$(".categoried").click((function(){var e=$(this);categorie_id=$(this).attr("data-id"),$.ajax({method:"post",url:"/coulisses/categorie/"+categorie_id+"/detach",data:{_token:$('[name="csrf-token"]').attr("content"),idType:t}}).done((function(t){e.parents("tr").first().remove()})).fail((function(e){console.log(e),alert("Connexion impossible pour détacher la catégorie.")}))}))}function i(){$(".categorieo").click((function(){$(this),categorie_id=$(this).attr("data-id"),$.ajax({method:"get",url:"/coulisses/categorie/"+categorie_id+"/edit"}).done((function(t){$("#modalCategorie").modal("show"),$('[name="name"]').val(t),e=categorie_id,$("#title-ajout").html("Modifier une catégorie")})).fail((function(e){console.log(e),alert("Connexion impossible pour éditer la catégorie.")}))}))}$('[name="choose_cat"]').popsuggest({placement:"left",dataUrl:"/coulisses/categorie_suggest/"+t,chainLength:1,rows:5,addData:{_token:$('[name="csrf-token"]').attr("content")}}).on("popSelect",(function(){var e;e=this.value,$.ajax({method:"post",url:"/coulisses/categorie/"+t+"/attach",data:{_token:$('[name="csrf-token"]').attr("content"),name:e},dataType:"json"}).done((function(e){e.error?alert(e.error):$("#categories-container").load("/coulisses/categorie?type_id="+t,(function(){i(),a(),o()}))})).fail((function(e){console.log(e),alert("Connexion impossible pour associer la catégorie.")})),this.value=""})),$("#ajout-categorie").click((function(){if(e)var n="put",c="/coulisses/categorie/"+e;else n="post",c="/coulisses/categorie";$.ajax({method:n,url:c,data:{_token:$('[name="csrf-token"]').attr("content"),name:$('[name="name"]').val(),type_id:t},dataType:"json"}).done((function(n){$("#categories-container").load("/coulisses/categorie?type_id="+t,(function(){i(),a(),o()})),$("#modalCategorie").modal("hide"),$("#name").val(""),e=!1,$("#title-ajout").html("Ajouter une catégorie"),$("input").removeClass("is-invalid")})).fail((function(t){$.each(t.responseJSON.errors,(function(e,t){var o="input[name="+e+"]";$(o).addClass("is-invalid"),$(o).next().html(t)})),e=!1}))})),$(".close").click((function(){e=!1,$("#title-ajout").html("Ajouter une catégorie"),$("input").removeClass("is-invalid")})),o(),a(),i()}));